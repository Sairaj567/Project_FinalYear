<%- include('../partials/header') %>

<div class="dashboard-container resume-builder-screen">
  <% if (currentUser && currentUser.role === 'student') { %>
    <%- include('../partials/student-nav') %>
  <% } else if (currentUser && currentUser.role === 'admin') { %>
    <%- include('../partials/admin-nav') %>
  <% } %>

  <div class="main-content" style="padding: 0;">
    <% if (currentUser && currentUser.role === 'admin') { %>
      <div class="card" style="margin: 20px;">
        <h4>Admin Preview Mode</h4>
        <p>AI interactions are disabled. Use the preview tab to review the student's resume output.</p>
      </div>
    <% } %>

    <div id="resume-builder-root"></div>
  </div>
</div>

<script src="https://cdn.tailwindcss.com"></script>
<script>
  tailwind.config = {
    theme: {
      extend: {
        colors: {
          'deep-purple': '#6366f1',
          'blue-accent': '#3b82f6',
          'teal-accent': '#14b8a6',
          'success-green': '#10b981',
          'warning-amber': '#f59e0b',
          'error-rose': '#f43f5e',
          'bg-light': '#f9fafb',
          'text-dark': '#1e293b'
        }
      }
    }
  };
</script>
<script id="initial-resume-json" type="application/json"><%- JSON.stringify(resumeDraft || null) %></script>
<script id="initial-resume-html" type="application/json"><%- JSON.stringify(resumeHtml || '') %></script>
<script>
  window.__API_BASE__ = window.location.origin;
  window.__CURRENT_USER_ROLE__ = "<%= currentUser ? currentUser.role : '' %>";
  const resumePayloadNode = document.getElementById('initial-resume-json');
  const resumeHtmlNode = document.getElementById('initial-resume-html');
  window.__INITIAL_RESUME__ = resumePayloadNode ? JSON.parse(resumePayloadNode.textContent || 'null') : null;
  window.__INITIAL_RESUME_HTML__ = resumeHtmlNode ? JSON.parse(resumeHtmlNode.textContent || '""') : '';
</script>
<script src="https://unpkg.com/react@18/umd/react.development.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://unpkg.com/lucide@latest"></script>
<script type="text/babel" src="/js/resume-builder.jsx"></script>

<%- include('../partials/footer') %>
